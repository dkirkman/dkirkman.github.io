<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-jsx-0dee3cdcbbfa86b7e891.js" as="script"/><link rel="preload" href="/component---src-templates-post-template-jsx-0a99ee157ec5942e8540.js" as="script"/><link rel="preload" href="/path---blog-2018-hello-gl-4b3014c5420f4eb68c22.js" as="script"/><link rel="preload" href="/app-1ec5b9e298d1f7f1259c.js" as="script"/><link rel="preload" href="/commons-2a1ac2ae0f864e4cea9b.js" as="script"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,700" rel="stylesheet"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><title data-react-helmet="true">Getting started with WebGL:  boilerplate for a world - Wild Silicon</title><meta data-react-helmet="true" name="description" content="Hello world, WebGL edition.  Because you can&#x27;t very well say hello without a world.  Provides some basic boilerplate for playing around with 3d objects, focusing on GLSL shaders."/><style id="gatsby-inlined-css">/*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 2.5rem}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 .125rem;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}[hidden],template{display:none}html{font-size:100}body{color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:500}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:26px;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:500}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.layout{max-width:66.875rem;margin-left:auto;margin-right:auto}.layout:after,.layout:before{content:"";display:table}.layout:after{clear:both}.content__inner{padding:1.5625rem 1.25rem}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}.content{width:calc(99.9% * 7/12 - 0.78125rem)}.content:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.content:last-child{margin-right:0}.content:nth-child(12n){margin-right:0;float:right}.content:nth-child(12n+1){clear:both}.content__inner{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.content{width:calc(99.9% * 2/3 - 0.625rem)}.content:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.content:last-child{margin-right:0}.content:nth-child(3n){margin-right:0;float:right}.content:nth-child(3n+1){clear:both}.content__inner{padding:2.5rem 2.1875rem}}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.tags__list-item-link{color:#222}.tags__list-item-link:focus,.tags__list-item-link:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.categories__list-item-link{color:#222}.categories__list-item-link:focus,.categories__list-item-link:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.post-single__inner{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.post-single__title{font-size:2rem;max-width:40rem;margin:1.625rem auto 0;font-weight:600;text-align:center;line-height:2.68125rem}.post-single__body figure{margin-bottom:1.625rem}.post-single__body figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.post-single__body figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.post-single__body a{text-decoration:underline}.post-single__body .gatsby-highlight{max-width:40rem;margin-left:.9375rem;margin-right:.9375rem;margin-bottom:1.625rem}.post-single__body :not(div){max-width:40rem;margin-left:auto;margin-right:auto}.post-single__footer{max-width:40rem;margin:1.625rem .9375rem 3.25rem;line-height:1.625rem}.post-single__footer-text a{text-decoration:underline}.post-single__date{max-width:40rem;margin-left:auto;margin-right:auto}.post-single__tags{margin-bottom:.8125rem}.post-single__tags-list{list-style:none;margin:0 -.3125rem;padding:0}.post-single__tags-list-item{display:inline-block;margin:.625rem .3125rem}.post-single__tags-list-item-link{background:#ebebeb;text-decoration:none;border:0;border-radius:.1875rem;color:#555;line-height:1.625;padding:.5rem 1rem}.post-single__tags-list-item-link:focus,.post-single__tags-list-item-link:hover{color:#222;background:#dfdfdf;border:0}.post-single__home-button{display:block;margin-left:auto;margin-right:auto;max-width:5.625rem;font-size:1rem;padding:0 1rem;height:35px;line-height:2.1875rem;text-align:center;color:#555;background:#ebebeb;font-weight:400;border-radius:.1875rem;margin-top:1.625rem}.post-single__home-button:focus,.post-single__home-button:hover{color:#222;background:#dfdfdf;border:0}@media screen and (min-width:685px){.post-single__body .gatsby-highlight,.post-single__footer{margin-left:auto;margin-right:auto}}@media screen and (min-width:960px){.post-single__inner{padding:0}.post-single__title{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.post-single__body,.post-single__body p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}.post-single__home-button{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}.menu{margin-bottom:1.625rem}.menu__list{list-style:none;padding:0;margin:0}.menu__list-item{padding:0;margin:.625rem 0}.menu__list-item-link{font-size:1rem;color:#222;font-weight:400;border:0}.menu__list-item-link:focus,.menu__list-item-link:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.menu__list-item-link--active{color:#222;border-bottom:1px solid #222}.links{margin-bottom:1.625rem}.links__list{display:-ms-flexbox;display:flex;list-style:none;padding:0;margin:.625rem -.1875rem}.links__list-item{padding:0;margin:0 .1875rem;height:24px;width:1.5rem;line-height:1.5rem;border-radius:.1875rem;text-align:center;background:#ebebeb}.links__list-item a{border:0}.links__list-item a i{font-size:.875rem;color:#555}.links__list-item a:focus i,.links__list-item a:hover i{color:#222}@font-face{font-family:fontello;src:url(/static/fontello.96eee913.eot);src:url(/static/fontello.96eee913.eot#iefix) format("embedded-opentype"),url(/static/fontello.07ad3c83.woff2) format("woff2"),url(/static/fontello.9aee3ebc.woff) format("woff"),url(/static/fontello.554de365.ttf) format("truetype"),url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtZXRhZGF0YT5Db3B5cmlnaHQgKEMpIDIwMTcgYnkgb3JpZ2luYWwgYXV0aG9ycyBAIGZvbnRlbGxvLmNvbTwvbWV0YWRhdGE+CjxkZWZzPgo8Zm9udCBpZD0iZm9udGVsbG8iIGhvcml6LWFkdi14PSIxMDAwIiA+Cjxmb250LWZhY2UgZm9udC1mYW1pbHk9ImZvbnRlbGxvIiBmb250LXdlaWdodD0iNDAwIiBmb250LXN0cmV0Y2g9Im5vcm1hbCIgdW5pdHMtcGVyLWVtPSIxMDAwIiBhc2NlbnQ9Ijg1MCIgZGVzY2VudD0iLTE1MCIgLz4KPG1pc3NpbmctZ2x5cGggaG9yaXotYWR2LXg9IjEwMDAiIC8+CjxnbHlwaCBnbHlwaC1uYW1lPSJtYWlsIiB1bmljb2RlPSImI3hlODAwOyIgZD0iTTkyOSAxMXY0MjhxLTE4LTIwLTM5LTM2LTE0OS0xMTUtMjM4LTE4OS0yOC0yNC00Ni0zN3QtNDgtMjgtNTctMTNoLTJxLTI2IDAtNTcgMTN0LTQ4IDI4LTQ2IDM3cS04OCA3NC0yMzggMTg5LTIxIDE2LTM5IDM2di00MjhxMC03IDYtMTN0MTItNWg4MjJxNyAwIDEyIDV0NiAxM3ogbTAgNTg2djE0dC0xIDctMSA3LTMgNS01IDQtOCAyaC04MjJxLTcgMC0xMi02dC02LTEycTAtOTQgODMtMTU5IDEwNy04NCAyMjMtMTc2IDQtMyAyMC0xN3QyNS0yMSAyNS0xNyAyOC0xNiAyNC01aDJxMTEgMCAyNCA1dDI4IDE2IDI1IDE3IDI1IDIxIDIwIDE3cTExNiA5MiAyMjQgMTc2IDMwIDI0IDU2IDY1dDI2IDczeiBtNzEgMjF2LTYwN3EwLTM3LTI2LTYzdC02My0yN2gtODIycS0zNiAwLTYzIDI3dC0yNiA2M3Y2MDdxMCAzNyAyNiA2M3Q2MyAyNmg4MjJxMzcgMCA2My0yNnQyNi02M3oiIGhvcml6LWFkdi14PSIxMDAwIiAvPgoKPGdseXBoIGdseXBoLW5hbWU9InR3aXR0ZXIiIHVuaWNvZGU9IiYjeGYwOTk7IiBkPSJNOTA0IDYyMnEtMzctNTQtOTAtOTMgMC04IDAtMjMgMC03My0yMS0xNDV0LTY0LTEzOS0xMDMtMTE3LTE0NC04Mi0xODEtMzBxLTE1MSAwLTI3NiA4MSAxOS0yIDQzLTIgMTI2IDAgMjI0IDc3LTU5IDEtMTA1IDM2dC02NCA4OXExOS0zIDM0LTMgMjQgMCA0OCA2LTYzIDEzLTEwNCA2MnQtNDEgMTE1djJxMzgtMjEgODItMjMtMzcgMjUtNTkgNjR0LTIyIDg2cTAgNDkgMjUgOTEgNjgtODMgMTY0LTEzM3QyMDgtNTVxLTUgMjEtNSA0MSAwIDc1IDUzIDEyN3QxMjcgNTNxNzkgMCAxMzItNTcgNjEgMTIgMTE1IDQ0LTIxLTY0LTgwLTEwMCA1MiA2IDEwNCAyOHoiIGhvcml6LWFkdi14PSI5MjguNiIgLz4KCjxnbHlwaCBnbHlwaC1uYW1lPSJmYWNlYm9vayIgdW5pY29kZT0iJiN4ZjA5YTsiIGQ9Ik01MzUgODQzdi0xNDdoLTg3cS00OCAwLTY1LTIwdC0xNy02MHYtMTA2aDE2NGwtMjItMTY1aC0xNDJ2LTQyNGgtMTcxdjQyNGgtMTQydjE2NWgxNDJ2MTIycTAgMTA0IDU4IDE2MXQxNTUgNTdxODIgMCAxMjctN3oiIGhvcml6LWFkdi14PSI1NzEuNCIgLz4KCjxnbHlwaCBnbHlwaC1uYW1lPSJyc3MiIHVuaWNvZGU9IiYjeGYwOWU7IiBkPSJNMjE0IDEwMHEwLTQ1LTMxLTc2dC03Ni0zMS03NiAzMS0zMSA3NiAzMSA3NiA3NiAzMSA3Ni0zMSAzMS03NnogbTI4Ni02OXExLTE1LTktMjYtMTAtMTItMjctMTJoLTc1cS0xNCAwLTI0IDl0LTExIDIzcS0xMiAxMjgtMTAzIDIxOXQtMjE5IDEwM3EtMTQgMS0yMyAxMXQtOSAyNHY3NXEwIDE2IDEyIDI2IDkgMTAgMjQgMTBoM3E4OS03IDE3MC00NXQxNDUtMTAxcTYzLTYzIDEwMS0xNDV0NDUtMTcxeiBtMjg2LTFxMS0xNS0xMC0yNi0xMC0xMS0yNi0xMWgtODBxLTE0IDAtMjUgMTB0LTEwIDIzcS03IDEyMC01NyAyMjh0LTEyOSAxODgtMTg4IDEyOS0yMjcgNTdxLTE0IDEtMjQgMTF0LTEwIDI0djgwcTAgMTYgMTEgMjYgMTAgMTAgMjUgMTBoMXExNDctOCAyODAtNjd0MjM4LTE2NHExMDQtMTA0IDE2NC0yMzh0NjctMjgweiIgaG9yaXotYWR2LXg9Ijc4NS43IiAvPgoKPGdseXBoIGdseXBoLW5hbWU9ImxpbmtlZGluIiB1bmljb2RlPSImI3hmMGUxOyIgZD0iTTE5NSA1MDF2LTU1M2gtMTg0djU1M2gxODR6IG0xMiAxNzFxMC00MS0yOS02OHQtNzUtMjdoLTFxLTQ2IDAtNzQgMjd0LTI4IDY4cTAgNDEgMjkgNjh0NzUgMjcgNzQtMjcgMjktNjh6IG02NTAtNDA3di0zMTdoLTE4M3YyOTZxMCA1OS0yMyA5MnQtNzEgMzNxLTM1IDAtNTgtMTl0LTM2LTQ4cS02LTE3LTYtNDV2LTMwOWgtMTg0cTEgMjIzIDEgMzYxdDAgMTY1bC0xIDI3aDE4NHYtODBoLTFxMTEgMTggMjMgMzF0MzEgMjkgNDkgMjQgNjQgOXE5NSAwIDE1My02M3Q1OC0xODZ6IiBob3Jpei1hZHYteD0iODU3LjEiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0iZ2l0aHViIiB1bmljb2RlPSImI3hmMTEzOyIgZD0iTTM1NyAxNzFxMC0yMi03LTQ1dC0yNC00My00MC0xOS00MSAxOS0yNCA0My03IDQ1IDcgNDYgMjQgNDMgNDEgMTkgNDAtMTkgMjQtNDMgNy00NnogbTM1NyAwcTAtMjItNy00NXQtMjQtNDMtNDAtMTktNDEgMTktMjQgNDMtNyA0NSA3IDQ2IDI0IDQzIDQxIDE5IDQwLTE5IDI0LTQzIDctNDZ6IG05MCAwcTAgNjctMzkgMTE0dC0xMDQgNDdxLTIzIDAtMTA5LTEyLTQwLTYtODgtNnQtODcgNnEtODUgMTItMTA5IDEyLTY2IDAtMTA0LTQ3dC0zOS0xMTRxMC00OSAxOC04NXQ0NS01OCA2OC0zMyA3OC0xNyA4My00aDk0cTQ2IDAgODMgNHQ3OCAxNyA2OSAzMyA0NSA1OCAxOCA4NXogbTEyNSA5OXEwLTExNi0zNC0xODUtMjItNDMtNTktNzR0LTc5LTQ4LTk1LTI3LTk2LTEyLTkzLTNxLTQzIDAtNzkgMnQtODIgNy04NSAxNy03NyAyOS02NyA0NS00OCA2NHEtMzUgNjktMzUgMTg1IDAgMTMyIDc2IDIyMS0xNSA0NS0xNSA5NSAwIDY0IDI4IDEyMSA2MSAwIDEwNi0yMnQxMDYtNjlxODIgMjAgMTcyIDIwIDgzIDAgMTU3LTE4IDU4IDQ2IDEwNCA2N3QxMDUgMjJxMjktNTcgMjktMTIxIDAtNDktMTUtOTQgNzYtODkgNzYtMjIyeiIgaG9yaXotYWR2LXg9IjkyOC42IiAvPgoKPGdseXBoIGdseXBoLW5hbWU9InN0YWNrb3ZlcmZsb3ciIHVuaWNvZGU9IiYjeGYxNmM7IiBkPSJNNzE5LTYxaC02MjR2MjY4aC04OXYtMzU3aDgwM3YzNTdoLTkwdi0yNjh6IG0tNTI1IDI5M2wxOCA4NyA0MzctOTItMTgtODd6IG01NyAyMDhsMzggODIgNDA0LTE4OS0zNy04MXogbTExMiAxOTlsNTcgNjkgMzQzLTI4Ny01Ny02OHogbTIyMiAyMTFsMjY2LTM1OC03MS01My0yNjcgMzU3eiBtLTQwMS04MjF2ODloNDQ3di04OWgtNDQ3eiIgaG9yaXotYWR2LXg9Ijg1Ny4xIiAvPgoKPGdseXBoIGdseXBoLW5hbWU9Imluc3RhZ3JhbSIgdW5pY29kZT0iJiN4ZjE2ZDsiIGQ9Ik01NzEgMzUwcTAgNTktNDEgMTAxdC0xMDEgNDItMTAxLTQyLTQyLTEwMSA0Mi0xMDEgMTAxLTQyIDEwMSA0MiA0MSAxMDF6IG03NyAwcTAtOTEtNjQtMTU2dC0xNTUtNjQtMTU2IDY0LTY0IDE1NiA2NCAxNTYgMTU2IDY0IDE1NS02NCA2NC0xNTZ6IG02MSAyMjlxMC0yMS0xNS0zNnQtMzctMTUtMzYgMTUtMTUgMzYgMTUgMzYgMzYgMTUgMzctMTUgMTUtMzZ6IG0tMjgwIDEyM3EtNCAwLTQzIDB0LTU5IDAtNTQtMi01Ny01LTQwLTExcS0yOC0xMS00OS0zMnQtMzMtNDlxLTYtMTYtMTAtNDB0LTYtNTgtMS01MyAwLTU5IDAtNDMgMC00MyAwLTU5IDEtNTMgNi01OCAxMC00MHExMi0yOCAzMy00OXQ0OS0zMnExNi02IDQwLTExdDU3LTUgNTQtMiA1OSAwIDQzIDAgNDIgMCA1OSAwIDU0IDIgNTggNSAzOSAxMXEyOCAxMSA1MCAzMnQzMiA0OXE2IDE2IDEwIDQwdDYgNTggMSA1MyAwIDU5IDAgNDMgMCA0MyAwIDU5LTEgNTMtNiA1OC0xMCA0MHEtMTEgMjgtMzIgNDl0LTUwIDMycS0xNiA2LTM5IDExdC01OCA1LTU0IDItNTkgMC00MiAweiBtNDI4LTM1MnEwLTEyOC0zLTE3Ny01LTExNi02OS0xODB0LTE3OS02OXEtNTAtMy0xNzctM3QtMTc3IDNxLTExNiA2LTE4MCA2OXQtNjkgMTgwcS0zIDQ5LTMgMTc3dDMgMTc3cTUgMTE2IDY5IDE4MHQxODAgNjlxNDkgMyAxNzcgM3QxNzctM3ExMTYtNiAxNzktNjl0NjktMTgwcTMtNDkgMy0xNzd6IiBob3Jpei1hZHYteD0iODU3LjEiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0idHVtYmxyIiB1bmljb2RlPSImI3hmMTczOyIgZD0iTTUyNyAxMDhsNDQtMTMycS0xMi0xOS02MS0zN3QtOTktMThxLTU4LTEtMTA3IDE1dC03OSA0MS01MyA1OS0zMSA2Ny05IDY2djMwNGgtOTR2MTIwcTQwIDE0IDcyIDM5dDUxIDUwIDMyIDU3IDE5IDU1IDggNDlxMSAzIDMgNXQ0IDJoMTM2di0yMzdoMTg2di0xNDBoLTE4NnYtMjg5cTAtMTcgMy0zMXQxMy0zMCAyOC0yMyA0NS04cTQ0IDEgNzUgMTZ6IiBob3Jpei1hZHYteD0iNTcxLjQiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0iZHJpYmJibGUiIHVuaWNvZGU9IiYjeGYxN2Q7IiBkPSJNNTcxIDEzcS0yMyAxMzQtNzggMjc4aC0xbC0xLTFxLTktMy0yNC05dC01Ni0yNy03Ny00Ni03My02NC01Ny04MmwtOSA2cTEwMy04NCAyMzQtODQgNzMgMCAxNDIgMjl6IG0tMTAzIDMzOXEtMTEgMjctMjkgNjItMTc0LTUyLTM3Ni01MiAwLTQgMC0xMiAwLTY5IDI0LTEzMnQ2OS0xMTJxMjggNDkgNjkgOTN0ODAgNjkgNzMgNDUgNTUgMjdsMjEgN3EyIDEgNyAydDcgM3ogbS01OSAxMThxLTY3IDExOS0xMzcgMjExLTc3LTM2LTEzMC0xMDR0LTcyLTE1MnExNjkgMCAzMzkgNDV6IG0zODEtMTc4cS0xMTcgMzMtMjI4IDE2IDQ5LTEzMyA3MS0yNjIgNjIgNDIgMTA0IDEwNnQ1MyAxNDB6IG0tNDQ5IDQxNHEtMSAwLTEtMSAwIDEgMSAxeiBtMzI5LTgxcS0xMDMgOTEtMjQxIDkxLTQzIDAtODctMTAgNzMtOTUgMTM3LTIxNCAzOSAxNSA3MyAzNHQ1NCAzNCAzNiAzMiAyMSAyM3ogbTEyNS0yNzFxLTIgMTI5LTgzIDIyOWwtMS0xcS01LTctMTEtMTN0LTI0LTI1LTQwLTM0LTU1LTM2LTc0LTM2cTE0LTMwIDI1LTUzIDEtMyAzLTEwdDUtOXEyMCAyIDQxIDR0NDEgMSAzOS0xIDM1LTIgMzItMyAyNy00IDIwLTMgMTQtM3ogbTYyLTRxMC0xMTctNTctMjE1dC0xNTYtMTU2LTIxNS01OC0yMTYgNTgtMTU1IDE1Ni01OCAyMTUgNTggMjE1IDE1NSAxNTYgMjE2IDU4IDIxNS01OCAxNTYtMTU2IDU3LTIxNXoiIGhvcml6LWFkdi14PSI4NTcuMSIgLz4KCjxnbHlwaCBnbHlwaC1uYW1lPSJza3lwZSIgdW5pY29kZT0iJiN4ZjE3ZTsiIGQ9Ik02NTUgMjU3cTAgMjgtMTEgNTF0LTI3IDM4LTQxIDI3LTQ2IDE5LTQ5IDEzbC01OCAxNHEtMTcgNC0yNSA2dC0xOSA2LTE3IDktOSAxMi00IDE2cTAgNDMgODAgNDMgMjQgMCA0My02dDMwLTE2IDIxLTE5IDIzLTE2IDI3LTdxMjYgMCA0MiAxOHQxNiA0M3EwIDMxLTMyIDU1dC03OSAzOC0xMDEgMTNxLTM4IDAtNzQtOXQtNjctMjYtNDktNDgtMTktNzJxMC0zNCAxMC02MHQzMi00MiA0NC0yNyA1OC0xOGw4MS0yMHE1MS0xMiA2My0yMCAxOC0xMSAxOC0zNCAwLTIxLTIzLTM2dC01OC0xNHEtMjkgMC01MSA5dC0zNyAyMi0yNSAyNS0yNiAyMS0zMCA5cS0yOCAwLTQyLTE3dC0xNC00MXEwLTUyIDY4LTg4dDE2Mi0zN3E0MSAwIDc4IDEwdDY5IDMwIDQ5IDUyIDE5IDc0eiBtMjAyLTEyMXEwLTg5LTYzLTE1MnQtMTUxLTYzcS03MyAwLTEzMSA0NS00My05LTgzLTktODAgMC0xNTMgMzF0LTEyNiA4NC04MyAxMjUtMzEgMTUzcTAgNDEgOSA4NC00NSA1OC00NSAxMzAgMCA4OSA2MyAxNTJ0MTUxIDYzcTczIDAgMTMxLTQ1IDQzIDkgODQgOSA3OSAwIDE1Mi0zMXQxMjYtODQgODQtMTI1IDMwLTE1M3EwLTQxLTgtODQgNDQtNTggNDQtMTMweiIgaG9yaXotYWR2LXg9Ijg1Ny4xIiAvPgoKPGdseXBoIGdseXBoLW5hbWU9InZrb250YWt0ZSIgdW5pY29kZT0iJiN4ZjE4OTsiIGQ9Ik0xMDcwIDU2MHExMy0zNi04NC0xNjQtMTMtMTgtMzYtNDgtMjItMjgtMzEtNDB0LTE3LTI3LTctMjQgOC0xOSAxOC0yNCAzMi0zMHEyLTEgMi0yIDc5LTczIDEwNy0xMjMgMi0zIDQtN3Q0LTE1LTEtMTktMTQtMTUtMzMtN2wtMTQyLTNxLTE0LTItMzIgM3QtMjkgMTNsLTExIDZxLTE3IDEyLTM5IDM2dC0zOCA0My0zNCAzMy0zMiA4cS0xIDAtNC0ydC0xMC04LTEyLTE2LTktMjktNC00NHEwLTgtMi0xNXQtNC0xMGwtMi0zcS0xMC0xMS0zMC0xMmgtNjRxLTQwLTMtODEgOXQtNzQgMjktNTcgMzctNDAgMzJsLTE0IDE0cS01IDUtMTUgMTd0LTQwIDUwLTU5IDg1LTY4IDExNy03MyAxNTJxLTQgOS00IDE1dDIgOWwyIDNxOSAxMSAzMiAxMWwxNTMgMXE3LTEgMTMtM3Q5LTVsMy0ycTktNiAxMy0xOCAxMS0yOCAyNi01N3QyMy00Nmw5LTE2cTE2LTM0IDMxLTU4dDI3LTM4IDIzLTIyIDE5LTggMTUgM3ExIDEgMyAzdDcgMTIgNyAyNiA1IDQ2IDAgNjlxLTEgMjMtNSA0MXQtNyAyNmwtNCA2cS0xNCAxOS00NyAyNC04IDIgMyAxNCA4IDEwIDIxIDE3IDI5IDE0IDEzMyAxMyA0Ni0xIDc1LTcgMTItMyAxOS04dDEyLTEzIDUtMTggMi0yNSAwLTMxLTItNDAgMC00NnEwLTYtMS0yM3QwLTI3IDItMjIgNi0yMiAxMy0xNHE0LTEgOS0ydDE1IDYgMjEgMTkgMjkgMzggMzggNjBxMzMgNTggNjAgMTI1IDIgNiA1IDEwdDYgNmwzIDIgMiAxdDggMiAxMSAwbDE2MCAxcTIyIDMgMzYtMXQxNy0xMHoiIGhvcml6LWFkdi14PSIxMDcxLjQiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0ic2xhY2siIHVuaWNvZGU9IiYjeGYxOTg7IiBkPSJNODQ4IDQxN3EzNCAwIDU3LTIzdDI0LTU2cTAtNTQtNTItNzNsLTk2LTMzIDMxLTkzcTQtMTIgNC0yNiAwLTMzLTI0LTU3dC01Ni0yNHEtMjYgMC00OCAxNXQtMjkgNDBsLTMxIDkyLTE3My01OSAzMS05MXE0LTE0IDQtMjcgMC0zMy0yMy01N3QtNTctMjRxLTI3IDAtNDggMTV0LTI5IDQxbC0zMSA5MS04NS0zMHEtMTctNS0yOC01LTM0IDAtNTcgMjJ0LTIzIDU3cTAgMjYgMTYgNDd0NDAgMzBsODcgMjktNTkgMTc1LTg3LTMwcS0xNC01LTI3LTUtMzMgMC01NiAyM3QtMjMgNTZxMCAyNiAxNSA0OHQ0MCAyOWw4OCAzMC0zMCA4OHEtNCAxNC00IDI3IDAgMzMgMjMgNTd0NTcgMjRxMjYgMCA0OC0xNnQyOS00MGwzMC04OSAxNzMgNTktMzAgODlxLTQgMTMtNCAyNiAwIDMzIDIzIDU3dDU3IDI0cTI2IDAgNDgtMTV0MzAtNDBsMjktOTAgOTEgMzFxMTEgMyAyNCAzIDMzIDAgNTctMjJ0MjQtNTVxMC0yNS0xNy00NXQtNDEtMjlsLTg4LTMwIDU5LTE3NyA5MSAzMnExMyA0IDI2IDR6IG0tNDQzLTE0NmwxNzMgNTgtNTkgMTc2LTE3My02MHoiIGhvcml6LWFkdi14PSI5MjguNiIgLz4KCjxnbHlwaCBnbHlwaC1uYW1lPSJwYXBlci1wbGFuZSIgdW5pY29kZT0iJiN4ZjFkODsiIGQ9Ik05ODQgODQ0cTE5LTEzIDE1LTM2bC0xNDItODU3cS0zLTE2LTE4LTI1LTgtNS0xOC01LTYgMC0xMyAzbC0yNTMgMTA0LTEzNS0xNjVxLTEwLTEzLTI3LTEzLTcgMC0xMiAyLTExIDQtMTcgMTN0LTcgMjF2MTk1bDQ4MiA1OTAtNTk2LTUxNi0yMjEgOTFxLTIwIDgtMjIgMzAtMSAyMyAxOCAzM2w5MjggNTM2cTkgNSAxOCA1IDExIDAgMjAtNnoiIGhvcml6LWFkdi14PSIxMDAwIiAvPgoKPGdseXBoIGdseXBoLW5hbWU9IndoYXRzYXBwIiB1bmljb2RlPSImI3hmMjMyOyIgZD0iTTU1MCAzMDdxNyAwIDU0LTI1dDUwLTMwcTEtMiAxLTggMC0xOC05LTQyLTktMjItNDAtMzd0LTU3LTE1cS0zMiAwLTEwNiAzNS01NSAyNS05NSA2NnQtODIgMTAzcS00MSA2MC00MCAxMDh2NXEyIDUwIDQxIDg4IDE0IDEyIDI5IDEyIDQgMCAxMC0xdDExLTFxMTEgMCAxNS0zdDgtMTZxNS0xMSAxOS00OXQxNC00MXEwLTEyLTE5LTMzdC0yMC0yNnEwLTMgMy04IDE5LTQxIDU3LTc2IDMxLTMwIDg0LTU3IDctNCAxMy00IDggMCAzMCAyN3QyOSAyOHogbS0xMTQtMjk2cTcxIDAgMTM2IDI4dDExMiA3NCA3NSAxMTIgMjggMTM2LTI4IDEzNi03NSAxMTItMTEyIDc1LTEzNiAyOC0xMzUtMjgtMTEyLTc1LTc1LTExMi0yOC0xMzZxMC0xMTMgNjctMjA1bC00NC0xMzAgMTM1IDQzcTg4LTU4IDE5Mi01OHogbTAgNzcxcTg2IDAgMTY0LTM0dDEzNC04OSA5MC0xMzUgMzMtMTYzLTMzLTE2My05MC0xMzQtMTM0LTkwLTE2NC0zNHEtMTA4IDAtMjAzIDUzbC0yMzMtNzUgNzYgMjI2cS02MCA5OS02MCAyMTcgMCA4NiAzMyAxNjN0OTAgMTM1IDEzNCA4OSAxNjMgMzR6IiBob3Jpei1hZHYteD0iODU3LjEiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0ib2Rub2tsYXNzbmlraSIgdW5pY29kZT0iJiN4ZjI2MzsiIGQ9Ik0zNTcgMzQ0cS0xMDUgMC0xNzkgNzR0LTc0IDE3OXEwIDEwNSA3NCAxNzl0MTc5IDc0IDE3OS03NCA3NS0xNzlxMC0xMDUtNzUtMTc5dC0xNzktNzR6IG0wIDM3OHEtNTEgMC04OC0zN3QtMzYtODhxMC01MiAzNi04OHQ4OC0zNyA4OCAzNyAzNyA4OHEwIDUyLTM3IDg4dC04OCAzN3ogbTI5Mi00MDlxNy0xNSA4LTI3dC0yLTIzLTE1LTIxLTI0LTIxLTM0LTIzcS02NC00MS0xNzYtNTNsNDEtNDAgMTQ5LTE0OXExNy0xNyAxNy00MXQtMTctNDFsLTctN3EtMTctMTctNDEtMTd0LTQxIDE3cS0zOCAzOC0xNDkgMTQ5bC0xNDktMTQ5cS0xOC0xNy00Mi0xN3QtNDAgMTdsLTcgN3EtMTcgMTctMTcgNDF0MTcgNDFsMTQ5IDE0OSA0MCA0MHEtMTEzIDEyLTE3NyA1My0yMSAxNC0zNCAyM3QtMjQgMjEtMTUgMjEtMiAyMyA4IDI3cTYgMTEgMTYgMjB0MjMgMTIgMzItMSAzNi0yMHEzLTIgOC02dDI0LTEzIDM5LTE3IDUxLTE0IDYzLTZxNTEgMCA5NyAxNHQ2NyAyOGwyMSAxNHExOSAxNSAzNyAyMHQzMSAxIDIzLTEyIDE2LTIweiIgaG9yaXotYWR2LXg9IjcxNC4zIiAvPgo8L2ZvbnQ+CjwvZGVmcz4KPC9zdmc+#fontello) format("svg");font-weight:400;font-style:normal}[class*=" icon-"]:before,[class^=icon-]:before{font-family:fontello;font-style:normal;font-weight:400;speak:none;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-mail:before{content:"\E800"}.icon-twitter:before{content:"\F099"}.icon-facebook:before{content:"\F09A"}.icon-rss:before{content:"\F09E"}.icon-linkedin:before{content:"\F0E1"}.icon-github:before{content:"\F113"}.icon-stackoverflow:before{content:"\F16C"}.icon-instagram:before{content:"\F16D"}.icon-tumblr:before{content:"\F173"}.icon-dribbble:before{content:"\F17D"}.icon-skype:before{content:"\F17E"}.icon-vkontakte:before{content:"\F189"}.icon-slack:before{content:"\F198"}.icon-paper-plane:before{content:"\F1D8"}.icon-whatsapp:before{content:"\F232"}.icon-odnoklassniki:before{content:"\F263"}.sidebar{width:100%}.sidebar__inner{position:relative;padding:1.5625rem 1.25rem 0}.sidebar__author-photo{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.sidebar__author-title{font-size:2rem;font-weight:500;line-height:1.82813rem;margin:.8125rem 0}.sidebar__author-title-link,.sidebar__author-title-link:focus,.sidebar__author-title-link:hover{color:#222}.sidebar__author-subtitle{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.sidebar__copyright{color:#b6b6b6;font-size:.875rem}@media screen and (min-width:685px){.sidebar{width:calc(99.9% * 5/12 - 1.09375rem);max-width:15.625rem}.sidebar:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.sidebar:last-child{margin-right:0}.sidebar:nth-child(12n){margin-right:0;float:right}.sidebar:nth-child(12n+1){clear:both}.sidebar__inner{padding:1.875rem 1.25rem 0}.sidebar__inner:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:540px;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.sidebar{width:calc(99.9% * 1/3 - 1.25rem);max-width:15.625rem}.sidebar:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.sidebar:last-child{margin-right:0}.sidebar:nth-child(3n){margin-right:0;float:right}.sidebar:nth-child(3n+1){clear:both}}.post{margin-bottom:2.03125rem}.post:last-child,.post__title{margin-bottom:.8125rem}.post__title{font-size:1.6875rem;line-height:2.4375rem;margin-top:0}.post__title-link{color:#222}.post__title-link:focus,.post__title-link:hover{color:#222;border-bottom:1px solid #222}.post__description{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.post__meta-time{font-size:.875rem;color:#222;font-weight:500;text-transform:uppercase}.post__meta-divider{margin:0 .3125rem}.post__meta-category-link{font-size:.875rem;color:#f7a046;font-weight:500;text-transform:uppercase}.post__meta-category-link:focus,.post__meta-category-link:hover{color:#5d93ff}.post__readmore{font-size:1rem;color:#5d93ff}.post__readmore:focus,.post__readmore:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.page{margin-bottom:3.25rem}.page__title{font-size:2.5rem;font-weight:500;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.page__body{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}</style></head><body><div id="___gatsby"><div class="layout" data-reactroot=""><div><div><div><a class="post-single__home-button" href="/">All Articles</a></div><div class="post-single"><div class="post-single__inner"><h1 class="post-single__title">Getting started with WebGL:  boilerplate for a world</h1><div class="post-single__body"><div><p><blog-hello-gl reactclass="HelloGL" meshsize="30" useTexturedEarth="true" lighting="directional">
</blog-hello-gl></p>
<p>This is quite literally “Hello World” implemented in WebGL.  I
recently became acquainted with WebGL through the Mozilla
<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial">tutorials</a>,
but this is the example program I wish I had when I was going through
that.  It’s small enough to be understandable in a short amount of
time, but substantial enough to serve as boilerplate for considerable
further exploration.  In particular, the shaders are just complicated
enough to demonstrate some key principles.</p>
<p>This kind of example is especially useful for WebGL, because typically
if you make an error in graphics programming you don’t get a nice error
message, or a stack trace.  All you usually get is a blank screen.  So
personally, I’ve found this program — which allows me to switch between
texturing or not texturing the object and switch between uniform and
directional lighting — to be quite useful when debugging various
3d objects I’ve been working on.</p>
<p>The code for this hello world is on
<a href="https://github.com/dkirkman/ws-hello-gl">github</a>.  That repo contains
both vanilla JS for hello world, and encapsulates it in a react
component — which is how it’s actually served on this page.  See the
repository page for details on how to use it as a react component.</p>
<p>Before I start describing the code I should note that I’m rather new
to WebGL.  I’ve done a lot of work with OpenGL, and with
<a href="https://en.wikipedia.org/wiki/PHIGS">PHIGS</a> before that, but not much
in the last decade.  So my work with WebGL and “modern” shaders is
only a few months old.  However, if you’re seeing a spinning globe
above you know the code works, even if my description of why it works
is a little off!</p>
<p>The entry point to the code <tt>hello_world</tt>, and it takes as parameters
the DOM object (usually a <tt>div</tt>) to place the GUI controls in,
a canvas to render the WebGL into, and some initial values for various
parameters.</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">hello_world</span><span class="token punctuation">(</span>controlDiv<span class="token punctuation">,</span> canvas<span class="token punctuation">,</span> meshSize<span class="token punctuation">,</span> lighting<span class="token punctuation">,</span>
                     useTexture<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> gl <span class="token operator">=</span> <span class="token function">initWebGL</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> programInfo 
          <span class="token operator">=</span> <span class="token function">initProgramInfo</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> vertexShaderSource<span class="token punctuation">,</span> 
                            fragmentShaderSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token function">initParams</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> programInfo<span class="token punctuation">,</span> meshSize<span class="token punctuation">,</span> 
                          lighting<span class="token punctuation">,</span> useTexture<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">initGUI</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> controlDiv<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">loadTexture</span><span class="token punctuation">(</span>
    gl<span class="token punctuation">,</span> 
    <span class="token string">&#x27;land_ocean_ice_cloud_2048.jpg&#x27;</span><span class="token punctuation">,</span> 
    texture <span class="token operator">=&gt;</span> <span class="token function">helloWorldAnimationLoop</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> texture<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p><tt>hello_world</tt> just initializes everything used in the demo,
and then ends by calling <tt>loadTexture</tt>
to load an image of the Earth, and when it’s ready to jump into
the main animation loop.</p>
<p><tt>loadTexture</tt> is just a slightly modified version of the code
used in the Mozilla
<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL">tutorial</a> on textures — look there
for details on how it works.</p>
<p>The earth image used as a texture is
<a href="https://eoimages.gsfc.nasa.gov/images/imagerecords/57000/57735/land_ocean_ice_cloud_2048.jpg">land_ocean_ice_cloud_2048.jpg</a>.
It’s part of NASA’s Visible Earth project.  Mission details, additional
formats and sizes, and Terms of Use (basically, anything goes as long
as you credit NASA) can be found
<a href="https://visibleearth.nasa.gov/view.php?id=57735">here</a>.</p>
<p>Once we have the texture loaded, we enter the main animation loop, which
is where all of the rendering actually takes place. </p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">helloWorldAnimationLoop</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> texture<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> time_start <span class="token operator">=</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// First time through, set parameters for gl.clear</span>
  gl<span class="token punctuation">.</span><span class="token function">clearColor</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  gl<span class="token punctuation">.</span><span class="token function">clearDepth</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 
  gl<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">DEPTH_TEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           
  gl<span class="token punctuation">.</span><span class="token function">depthFunc</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">LEQUAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            

  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>time_now<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> delta_time <span class="token operator">=</span> time_now <span class="token operator">-</span> time_start<span class="token punctuation">;</span>
    <span class="token keyword">const</span> theta <span class="token operator">=</span> delta_time<span class="token operator">*</span><span class="token number">0.001</span><span class="token operator">*</span><span class="token number">0.5</span><span class="token punctuation">;</span> 
    <span class="token keyword">let</span> obj <span class="token operator">=</span> params<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>
        
    gl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">COLOR_BUFFER_BIT</span> <span class="token operator">|</span> gl<span class="token punctuation">.</span><span class="token constant">DEPTH_BUFFER_BIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    
    <span class="token function">drawObject</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>params<span class="token punctuation">.</span>distance<span class="token punctuation">,</span> 
               params<span class="token punctuation">.</span>phi<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>multipleEarth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">drawAdditionalEarths</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
        
    window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Kick it off the first time</span>
  window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<h2>Initialization</h2>
<p>The action <tt>helloWorldAnimationLoop</tt> takes place in
<tt>drawObject</tt>, which we’ll get to shortly.  But before we
do that we should look a bit more closely at the initialization code,
because I think that’s where the most important concepts are located.</p>
<p>Initializing WebGL is quite straightforward, all you need is a canvas.</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">initWebGL</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> gl <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;webgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;can&#x27;t find any webgl -- &quot;</span> <span class="token operator">+</span> 
                <span class="token string">&quot;this is not going to work&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Your browser does not support WebGL&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> gl<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>I’m putting everything configurable into an easy to pass around
object, it’s built up with <tt>initParams</tt></p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">initParams</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> programInfo<span class="token punctuation">,</span> meshSize<span class="token punctuation">,</span> lighting<span class="token punctuation">,</span> 
                    useTexture<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>useTexture<span class="token punctuation">:</span> useTexture<span class="token punctuation">,</span>
                multipleEarth<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                lighting<span class="token punctuation">:</span> lighting<span class="token punctuation">,</span>
                meshSize<span class="token punctuation">:</span> meshSize<span class="token punctuation">,</span>
                distance<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
                phi<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                obj<span class="token punctuation">:</span> <span class="token function">makeSphere</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> meshSize<span class="token punctuation">)</span><span class="token punctuation">,</span>
                programInfo<span class="token punctuation">:</span> programInfo
               <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> params<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p><tt>initGUI</tt> initializes the
<a href="https://github.com/dataarts/dat.gui"><tt>dat.gui</tt></a> GUI.  It’s not
all that interesting.  But it is sort of essential to make the code actually
interactive.  For details look in the repo.</p>
<p><tt>initProgramInfo</tt> is probably the most important piece
of this program to truly understand.  At first glance, it looks
straightforward:  it creates a WebGL program from source for
a vertex and fragment shader, and then creates an object with that
program and some precomputed “locations”.</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">initProgramInfo</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> vertexSource<span class="token punctuation">,</span> fragmentSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> shaderProgram <span class="token operator">=</span> <span class="token function">initShaderProgram</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> vertexSource<span class="token punctuation">,</span> 
                                          fragmentSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> programInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
    program<span class="token punctuation">:</span> shaderProgram<span class="token punctuation">,</span>
    attribLocations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      vertexPosition<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> 
                                           <span class="token string">&#x27;aVertexPosition&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      vertexNormal<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> 
                                         <span class="token string">&#x27;aVertexNormal&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      textureCoord<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> 
                                         <span class="token string">&#x27;aTextureCoord&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      vertexColor<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> 
                                        <span class="token string">&#x27;aVertexColor&#x27;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    uniformLocations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      projectionMatrix<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span>
                                              <span class="token string">&#x27;uProjectionMatrix&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      modelViewMatrix<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span>
                                             <span class="token string">&#x27;uModelViewMatrix&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      normalMatrix<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span>
                                          <span class="token string">&#x27;uNormalMatrix&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      directionalLighting<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span>
                                                 <span class="token string">&#x27;uDirectionalLighting&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      useTexture<span class="token punctuation">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span>
                                        <span class="token string">&#x27;uUseTexture&#x27;</span><span class="token punctuation">)</span>      
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> programInfo<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>A key thing to recognize is that the <tt>attribLocations</tt> and
<tt>uniformLocations</tt> correspond to variables in the shaders, and
binding arrays to those locations is how we are going to communicate
with the shaders.</p>
<h2>Shaders</h2>
<p>If you’re not already familiar with how WebGL shaders work, the 30
second description is this.  When rendering a scene, the first thing
that happens is that the vertex shader is called for each vertex.  You
pass information to the vertex shader via <tt>uniformLocations</tt>
for things that are constant for each vertex, and via
<tt>attribLocations</tt> for things that are unique to each vertex.
Things that are unique to each vertex are things like vertex positions,
colors, texture coordinates, etc.</p>
<p>To actually fill in a triangle, after the vertex shader has computed
various values for each vertex, those values are interpolated between
the vertices and passed to a fragment shader, which is called once
for each pixel in the triangle.  We’ll return to fragment shaders
shortly.</p>
<p>The vertex shader for this program is embedded in the javascript code
as a string literal.</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> vertexShaderSource <span class="token operator">=</span> <span class="token template-string"><span class="token string">`
    attribute vec3 aVertexNormal;
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aVertexColor;

    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;
    uniform mat4 uNormalMatrix;

    uniform float uDirectionalLighting;

    varying highp vec3 vLighting;
    varying highp vec2 vTextureCoord;
    varying highp vec4 vColor;

    void main() {
      gl_Position =   uProjectionMatrix * uModelViewMatrix 
                    * vec4(aVertexPosition, 1);

      if (uDirectionalLighting &gt; 0.0) {
         highp vec3 ambientLight = vec3(0.1, 0.1, 0.1);
         highp vec3 directionalLightColor = vec3(1, 1, 1);
         highp vec3 directionalVector 
            = normalize(vec3(1.0, 0.3, 0.5));

         highp vec4 transformedNormal 
            = uNormalMatrix * vec4(aVertexNormal, 1.0);

         highp float directional = max(
            dot(transformedNormal.xyz, directionalVector), 
            0.0
         );

         vLighting = ambientLight 
                   + (directionalLightColor * directional);
      } else {
         vLighting = vec3(1.0, 1.0, 1.0);
      }

      vTextureCoord = aTextureCoord;
      vColor = aVertexColor;
    }
  `</span></span><span class="token punctuation">;</span></code></pre>
      </div>
<p>The shader is written in
<a href="https://en.wikipedia.org/wiki/OpenGL_Shading_Language">GLSL</a>.  It you
know a c-like language (e.g. javascript!) it should be pretty easy to
understand what’s going on.  For a high level understanding, the key
thing to look at are the Hungarian style variable definitions at the
top of the shader.</p>
<p>We’ve already briefly discussed the <tt>attrib</tt> and <tt>uniform</tt>
definitions — they
are the way we get information into the vertex shader.  The <tt>varying</tt>
definitions are how we communicate between the vertex and fragment shaders.
They get computed at each vertex, and when each pixel is rendered by the
fragment shader the <tt>varying</tt> parameters are interpolated between
the various indices in the triangle.</p>
<p>Also of note is the setting of <tt>gl_Position</tt>.  That is a magic
variable that needs to be set for each vertex describing where exactly
to place the vertex in screen coordinates.</p>
<p>The fragment shader looks like</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> fragmentShaderSource <span class="token operator">=</span> <span class="token template-string"><span class="token string">`
    varying highp vec3 vLighting;
    varying highp vec2 vTextureCoord;
    varying highp vec4 vColor;

    uniform sampler2D uSampler;
    uniform lowp float uUseTexture;

    void main() {
      highp vec4 color;
      if (uUseTexture &gt; 0.0) {
         color = texture2D(uSampler, vTextureCoord);
      } else {
         color = vColor;
      }

      gl_FragColor = vec4(color.rgb * vLighting, color.a);
    }
  `</span></span><span class="token punctuation">;</span></code></pre>
      </div>
<p>it receives <tt>varying</tt> parameters from the vertex shaders,
and <tt>uniform</tt> that don’t vary for any pixel, in this case
whether or not we should use a texture at all (<tt>uUseTexture</tt>),
and if we should use a texture there is a parameter to actually sample
it (<tt>uSampler</tt>)</p>
<p>Like <tt>gl_Position</tt>
in the vertex shader,
<tt>gl_FragColor</tt>
sets the key output of a fragment shader — the color of the pixel being
rendered.</p>
<p>This fragment shader has some simple logic to use a <tt>uniform</tt>
to switch between rendering based on a texture or based on the underlying
vertex colors.</p>
<h2>Constructing a Sphere</h2>
<p>The code above will display any object, as long as the object defines
positions, normals, colors, and textureCoords for it’s constituent
triangles.  The spheres displayed by <tt>hello_world</tt> are constructed
like so:</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">makeSphere</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> meshSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> positions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> normals <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> indices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> textureCoords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;=</span>meshSize<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>meshSize<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> long <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span>meshSize<span class="token punctuation">)</span> <span class="token operator">*</span> i<span class="token punctuation">;</span>
      <span class="token keyword">let</span> lat <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span>meshSize<span class="token punctuation">)</span> <span class="token operator">*</span> j<span class="token punctuation">;</span>
      
      <span class="token keyword">let</span> index <span class="token operator">=</span> j<span class="token operator">*</span><span class="token punctuation">(</span>meshSize<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>

      <span class="token function">setPositions</span><span class="token punctuation">(</span>positions<span class="token punctuation">,</span> index<span class="token punctuation">,</span> long<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setNormals</span><span class="token punctuation">(</span>normals<span class="token punctuation">,</span> index<span class="token punctuation">,</span> long<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setTextureCoords</span><span class="token punctuation">(</span>textureCoords<span class="token punctuation">,</span> index<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> 
                       meshSize<span class="token punctuation">,</span> meshSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setColors</span><span class="token punctuation">(</span>colors<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">setIndices</span><span class="token punctuation">(</span>indices<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> meshSize<span class="token punctuation">,</span> meshSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">const</span> indexBuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ELEMENT_ARRAY_BUFFER</span><span class="token punctuation">,</span> indexBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ELEMENT_ARRAY_BUFFER</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Uint16Array</span><span class="token punctuation">(</span>indices<span class="token punctuation">)</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">{</span>vertexBuffer<span class="token punctuation">:</span> <span class="token function">bindFloatBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> positions<span class="token punctuation">)</span><span class="token punctuation">,</span>
          colorBuffer<span class="token punctuation">:</span> <span class="token function">bindFloatBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> colors<span class="token punctuation">)</span><span class="token punctuation">,</span>
          normalBuffer<span class="token punctuation">:</span> <span class="token function">bindFloatBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> normals<span class="token punctuation">)</span><span class="token punctuation">,</span>
          indexBuffer<span class="token punctuation">:</span> indexBuffer<span class="token punctuation">,</span>
          textureBuffer<span class="token punctuation">:</span> <span class="token function">bindFloatBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> textureCoords<span class="token punctuation">)</span><span class="token punctuation">,</span>
          vertexCount<span class="token punctuation">:</span> indices<span class="token punctuation">.</span>length<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>It’s a bit long, but fundamentally not too complicated.  We just iterate
over squares in latitude/longitude, and tile each square
with two triangles.  Even though we could share vertices between the
triangles, in this case we do not.  By having a unique vertex for each
corner of each triangle, we can alternate the color of the triangles and
make the mesh easy to visualize.  The visualization is not so interesting
for the completed sphere, but it was mighty handy when I screwed up the
first few versions of <tt>makeSphere</tt>!</p>
<p>The structure of setting two triangles to cover each latitude/longitude
rectangle is obvious in the code that assigns the positions and normals</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">setPositions</span><span class="token punctuation">(</span>positions<span class="token punctuation">,</span> index<span class="token punctuation">,</span> long<span class="token punctuation">,</span> lat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  positions<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  positions<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  positions<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  positions<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  positions<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  positions<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">setNormals</span><span class="token punctuation">(</span>normals<span class="token punctuation">,</span> index<span class="token punctuation">,</span> long<span class="token punctuation">,</span> lat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  normals<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  normals<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  normals<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  normals<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  normals<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>long<span class="token punctuation">)</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  normals<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>In the case of a unit sphere, the unit normals just <em>happen</em> to
be the same as the vertex positions, but of course that won’t be
the case for anything that isn’t a unit sphere.</p>
<p>Because out texture image is a flattened sphere, the texture coordinates
of each vertex map directly onto the image</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">setTextureCoords</span><span class="token punctuation">(</span>textureCoords<span class="token punctuation">,</span> index<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> nlong<span class="token punctuation">,</span> nlat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  textureCoords<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">/</span>nlong<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
  textureCoords<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token operator">/</span>nlat<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
  
  textureCoords<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">/</span>nlong<span class="token punctuation">;</span>
  textureCoords<span class="token punctuation">[</span>index<span class="token operator">*</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token operator">/</span>nlat<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>Note that while each position requires 3 elements, the texture coordinates only
set 2 elements.  How does WebGL work out that the positions and normals
effectively have different strides?  It’s done when we bind the attributes
before rendering — we’ll have an opportunity to set the stride for each
array then.</p>
<p>Also Note that <tt>makeSphere</tt> binds its vertex data into WebGL
buffers.  If you don’t want to run out of GPU memory (I’m pretty sure
you don’t) you need to free those buffers if you get rid of your
object.  <tt>hello_world</tt> uses the following little helper for this</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">deleteObj</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gl<span class="token punctuation">.</span><span class="token function">deleteBuffer</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>vertexBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">deleteBuffer</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>colorBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">deleteBuffer</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>normalBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">deleteBuffer</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>indexBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">deleteBuffer</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>textureBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>I’ve glossed over some very basic WebGL concepts like the modelViewMatrix
and the normalMatrix.  Those are, of course, essential to understand in the
long run, but at the start of a 3d journey I think they’re not terribly
important.  All you’ve got to know is that for viewing “standard objects”,
you just translate and rotate the modelViewMatrix like we do in
<tt>drawObject</tt></p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">drawObject</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> offset_x<span class="token punctuation">,</span> offset_y<span class="token punctuation">,</span> 
                    offset_z<span class="token punctuation">,</span> phi<span class="token punctuation">,</span> theta<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> modelViewMatrix <span class="token operator">=</span> mat4<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  mat4<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>modelViewMatrix<span class="token punctuation">,</span>     
                 modelViewMatrix<span class="token punctuation">,</span>     
                 <span class="token punctuation">[</span>offset_x<span class="token punctuation">,</span> offset_y<span class="token punctuation">,</span> offset_z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  
  mat4<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>modelViewMatrix<span class="token punctuation">,</span>
              modelViewMatrix<span class="token punctuation">,</span>
              <span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span><span class="token number">2.0</span> <span class="token operator">+</span> phi<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span><span class="token number">180.0</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  mat4<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>modelViewMatrix<span class="token punctuation">,</span>
              modelViewMatrix<span class="token punctuation">,</span>
              theta<span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> obj <span class="token operator">=</span> params<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>
  <span class="token function">bindAndRender</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> modelViewMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p><tt>bindAndRender</tt> just binds the uniforms and attributes, and then
does the actual drawing</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">bindAndRender</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> modelViewMatrix<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gl<span class="token punctuation">.</span><span class="token function">useProgram</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>programInfo<span class="token punctuation">.</span>program<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">bindAttribs</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">bindUniforms</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> params<span class="token punctuation">,</span> obj<span class="token punctuation">,</span> modelViewMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token punctuation">{</span>
    <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token constant">UNSIGNED_SHORT</span><span class="token punctuation">;</span>
    gl<span class="token punctuation">.</span><span class="token function">drawElements</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>vertexCount<span class="token punctuation">,</span> type<span class="token punctuation">,</span> 
                    offset<span class="token punctuation">)</span><span class="token punctuation">;</span>        
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>I may write another post about the modelViewMatrix, but for the moment
if you want to understand it better I’d head to the Mozilla
<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Getting_started_with_WebGL">tutorials</a>.</p>
<p>That’s about it.  For the full source grab the github
<a href="https://github.com/dkirkman/ws-hello-gl">repo</a>.  (Note that if you
want to play with this you <em>must</em> grab a copy of the repo — the
snippets on this page do not include some not very interesting but
utterly essential routines!) If your WebGL journey is still in its
early days, I think it’s an excellent example to play around with.
Have fun!</p></div></div><div class="post-single__date"><em>Published <!-- -->31 May 2018</em></div></div><div class="post-single__footer"><div class="post-single__tags"><ul class="post-single__tags-list"><li class="post-single__tags-list-item"><a class="post-single__tags-list-item-link" href="/blog/tags/web-gl/">WebGL</a></li><li class="post-single__tags-list-item"><a class="post-single__tags-list-item-link" href="/blog/tags/development/">development</a></li></ul></div><hr/><p class="post-single__footer-text">Comments?  I&#x27;d love to hear them.  Send them to <a href="mailto:dkirkman@gmail.com">dkirkman@gmail.com</a><br/><p class="sidebar__copyright">Copyright © 2018 David Kirkman. All rights reserved.</p></p><div></div></div></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-1ec5b9e298d1f7f1259c.js","99219681209289":"component---node-modules-gatsby-plugin-offline-app-shell-js-5c4c5a0f7af9dc69d6d7.js","108009296967943":"component---src-templates-post-template-jsx-0a99ee157ec5942e8540.js","276164273576076":"ws-demon-7da3b65eb667401e796d.js","112293606465964":"ws-colormap-b59a5b91a0fe048ebeb8.js","111187913991432":"ws-munker-illusion-3c226a2276a6c4f06416.js","111440569617658":"ws-hello-gl-60a6a3ebc7451f3cc543.js","2638498282051":"component---src-templates-tag-template-jsx-06fbd3473ea34e10770a.js","90179704293519":"component---src-templates-category-template-jsx-cf1c8b990648253d5738.js","11305920230724":"component---src-templates-page-template-jsx-994fa15cdac2f9049e27.js","183328146348521":"component---src-pages-404-jsx-3d0441dd1a11b2f3a35b.js","112012376896560":"component---src-pages-blog-categories-jsx-636711a7777a582d73e4.js","4220841425358":"component---src-pages-blog-index-jsx-75a4c7799d477287fbb2.js","195694832364976":"component---src-pages-blog-tags-jsx-1984f202b3aca7702e41.js","213534597649335":"component---src-pages-index-jsx-129a40718ebac028a017.js","60335399758886":"path----557518bd178906f8d58a.js","210333531512890":"path---offline-plugin-app-shell-fallback-a0e39f21c11f6a62c5ab.js","25236774834544":"path---blog-2018-cyclical-colormaps-5e66cda443e8ca49533f.js","89040563376891":"path---blog-tags-interactive-computation-7e7e4f7ca96d546c339f.js","197009827592903":"path---blog-tags-data-science-8cb4ac927e1bd20858f5.js","142963898409560":"path---blog-categories-visualization-37422e5b96035512d842.js","273950069227526":"path---about-b20b4e4015d27b24abf2.js","233755054307173":"path---blog-2018-munker-illusion-7a1272337d7de08fec70.js","84371913337507":"path---blog-tags-illusions-1e5e5c70a6db28d6d1dd.js","61745982507851":"path---blog-tags-psychophysics-c67dd1b2ae7e72a81aad.js","66294210697935":"path---blog-2018-demon-2e9ebccc9c987239338a.js","216920128278311":"path---blog-tags-cellular-automata-5c7d768bb61791a79beb.js","116017073866886":"path---blog-2018-hello-gl-4b3014c5420f4eb68c22.js","137652537803549":"path---blog-tags-web-gl-2229c02877d2e53e59fe.js","137790038830570":"path---blog-tags-development-4a93b5cc0def8231981a.js","19606274489838":"path---blog-categories-development-baffba874a102979d672.js","254022195166212":"path---404-b68206950856f877b606.js","260099070806502":"path---blog-categories-88e26dcf41a78838b98f.js","49683490770531":"path---blog-2f3df7ea017ed333faf7.js","186779927453684":"path---blog-tags-bfc3f49ca660da608258.js","142629428675168":"path---index-2f3df7ea017ed333faf7.js","178698757827068":"path---404-html-b68206950856f877b606.js","79611799117203":"component---src-layouts-index-jsx-0dee3cdcbbfa86b7e891.js"}/*]]>*/</script><script>
            
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-3204116-4',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-3204116-4', 'auto');
      ga('set', 'anonymizeIp', 1);}
      </script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/commons-2a1ac2ae0f864e4cea9b.js","/app-1ec5b9e298d1f7f1259c.js","/path---blog-2018-hello-gl-4b3014c5420f4eb68c22.js","/component---src-templates-post-template-jsx-0a99ee157ec5942e8540.js","/component---src-layouts-index-jsx-0dee3cdcbbfa86b7e891.js"])/*]]>*/</script></body></html>